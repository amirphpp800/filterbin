// Podcast episodes data with full content
const podcastEpisodes = {
    1: {
        id: 1,
        title: 'ูุงููู ู ูฺฉุฑุงูุโ ุจุฏูู ุขุจ ู ุขูุชู',
        date: 'ฑฒ ุฎุฑุฏุงุฏ ฑดฐณ',
        duration: '20:29',
        audioUrl: '#', // Add actual audio URL
        thumbnail: '../assets/images/laye7/E1.png',
        content: `
            <h2>ุฏุฑุจุงุฑู ุงู ุงูพุฒูุฏ</h2>
            <p>ุฏุฑ ุงู ุงูพุฒูุฏ ุจู ุจุฑุฑุณ ุณุงูุงูู ุณุชุงู ู ฺฉูุชุฑู ุจโูพุงุงู ูพูุดุด ุฒุจุงู ุฏุฑ ุงุฑุงู ูพุฑุฏุงุฎุชู ู ุงุฒ ุชูุฏุฏ ูุฒุงูุฏู.</p>
            
            <h3>ุงูฺฏูุฑุชู ุนูุงุฏุ ุณุงูุงูู ุณุชุงู ู ฺฉูุชุฑู ุจโูพุงุงู ูพูุดุด ุฒุจุงู ุฏุฑ ุงุฑุงู</h3>
            <p>ุฏุฑ ุณุฑูุณ ูุณูุช ุงุชุตุงู ุณูู ูพุงุฏฺฉุณุช ูุงู ููุชูุ ุงู ููุถูุน ุจุง ุชูุฑฺฉุฒ ุจุฑ ฺฉุงุฑฺฉุฑุฏ ุชุญูู ูพุฑูุณู ุฏุฑ ููุฑุฏ ูุฒุงูุฏู ุงุณุช. ูุฎุณุชู ุฏูุฑู ุจุฑุฑุณ ุงุฒ ฺฉุงุฑุจุฑุฏ ุณุงูุงูู ุณุชุงู ู ููุด ุขู ุฏุฑ ฺฉูุชุฑู ุงุทูุงุนุงุช ู ูุธุงุฑุช ุจุฑ ุดูุฑููุฏุงูุ ุชุง ุชุญูู ุงุจุนุงุฏ ูุฎุชูู ุงู ุณุงูุงูู ู ุชุฃุซุฑุงุช ุขู ุจุฑ ุญุฑู ุฎุตูุต ู ุขุฒุงุฏ ุจุงู ูพุฑุฏุงุฎุชู ูโุดูุฏ.</p>

            <blockquote>
            ุณุงูุงูู ุณุชุงู ุงุจุฒุงุฑ ูุฏุฑุชููุฏ ุจุฑุง ฺฉูุชุฑู ูุถุง ุฏุฌุชุงู ู ูุธุงุฑุช ุจุฑ ุดูุฑููุฏุงู ุงุณุช ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชูโูุง ูพฺุฏูุ ุฑูุชุงุฑ ุขููุงู ุงูุฑุงุฏ ุฑุง ุฑุตุฏ ู ุชุญูู ูโฺฉูุฏ.
            </blockquote>

            <h3>ูฺฉุงุช ฺฉูุฏ ุงู ุงูพุฒูุฏ:</h3>
            <ul>
                <li>ุชุงุฑุฎฺู ู ฺฺฏููฺฏ ุฑุงูโุงูุฏุงุฒ ุณุงูุงูู ุณุชุงู ุฏุฑ ุงุฑุงู</li>
                <li>ููุด ุงูฺฏูุฑุชูโูุง ุฏุฑ ฺฉูุชุฑู ูุญุชูุง ุฏุฌุชุงู</li>
                <li>ุชุฃุซุฑุงุช ุณุงูุงูู ุจุฑ ุญุฑู ุฎุตูุต ุดูุฑููุฏุงู</li>
                <li>ุฑูุดโูุง ููุงุจูู ู ุญูุงุธุช ุงุฒ ุงุทูุงุนุงุช ุดุฎุต</li>
                <li>ููุงุณู ุจุง ุณุณุชูโูุง ูุดุงุจู ุฏุฑ ุณุงุฑ ฺฉุดูุฑูุง</li>
            </ul>

            <h3>ููุงุจุน ู ูุทุงูุนุงุช ุจุดุชุฑ</h3>
            <p>ุจุฑุง ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑุจุงุฑู ุณุงูุงูู ุณุชุงู ู ุชุฃุซุฑุงุช ุขูุ ูโุชูุงูุฏ ุจู ฺฏุฒุงุฑุดโูุง ุณุงุฒูุงูโูุง ุญููู ุจุดุฑ ู ุชุญููุงุช ุฏุงูุดฺฏุงู ุฏุฑ ุงู ุฒููู ูุฑุงุฌุนู ฺฉูุฏ.</p>
        `
    },
    2: {
        id: 2,
        title: 'ุชุงุฑุฎ ุดูุงู ุณุงูุณูุฑ ู ููุงููุช ุฏุฌุชุงู',
        date: 'ฒน ุงุฑุฏุจูุดุช ฑดฐณ',
        duration: '22:15',
        audioUrl: '#',
        thumbnail: '../assets/images/laye7/E2.png',
        content: `
            <h2>ุฏุฑุจุงุฑู ุงู ุงูพุฒูุฏ</h2>
            <p>ุฏุฑ ุงู ูุณูุช ุจู ุชุญูู ุฑูุดโูุง ุฌุฏุฏ ฺฉูุฏุดฺฉุงู ู ูุธุงุฑุช ุจุฑ ุงุฑุชุจุงุทุงุช ุฏุฌุชุงู ุฏุฑ ุงุฑุงู ูโูพุฑุฏุงุฒู.</p>
            
            <h3>ฺฉูุฏุดฺฉุงู ุงุณุชุฎุฑุงุฌ ฺุณุชุ</h3>
            <p>ฺฉูุฏุดฺฉุงู ุงุณุชุฎุฑุงุฌ ฺฉ ุงุฒ ูพุดุฑูุชูโุชุฑู ุฑูุดโูุง ูุธุงุฑุช ุจุฑ ุงุฑุชุจุงุทุงุช ุฑูุฒูฺฏุงุฑ ุดุฏู ุงุณุช ฺฉู ุฏุฑ ุขู ุจู ุฌุง ุดฺฉุณุชู ุฑูุฒูฺฏุงุฑุ ฺฉูุฏูุง ุฑูุฒูฺฏุงุฑ ุงุฒ ุฏุณุชฺฏุงูโูุง ุงุณุชุฎุฑุงุฌ ูโุดููุฏ.</p>

            <h3>ูฺฉุงุช ููู:</h3>
            <ul>
                <li>ุฑูุดโูุง ุงุณุชุฎุฑุงุฌ ฺฉูุฏูุง ุฑูุฒูฺฏุงุฑ</li>
                <li>ุชุฃุซุฑ ุจุฑ ุงููุช ุงุฑุชุจุงุทุงุช</li>
                <li>ุฑุงูฺฉุงุฑูุง ูุญุงูุธุช ุงุฒ ฺฉูุฏูุง ุฎุตูุต</li>
                <li>ุงุณุชูุงุฏู ุงุฒ ุฑูุฒูฺฏุงุฑ ุณุฎุชโุงูุฒุงุฑ</li>
            </ul>
        `
    },
    3: {
        id: 3,
        title: 'ุจุงููุงุณฺฉู ุจุง ุจุฑุงุฏุฑ ุจุฒุฑฺฏ',
        date: 'ฑต ุงุฑุฏุจูุดุช ฑดฐณ',
        duration: '25:40',
        audioUrl: '#',
        thumbnail: '../assets/images/laye7/E3.png',
        content: `
            <h2>ุฑุงูููุง ุฌุงูุน VPN</h2>
            <p>ุฏุฑ ุงู ุงูพุฒูุฏ ุจู ุจุฑุฑุณ ฺฉุงูู VPNโูุง ู ูุญูู ุงูุชุฎุงุจ ู ุงุณุชูุงุฏู ุงุฒ ุขูโูุง ุฏุฑ ุดุฑุงุท ุจุญุฑุงู ูโูพุฑุฏุงุฒู.</p>
            
            <h3>ูุนุงุฑูุง ุงูุชุฎุงุจ VPN ููุงุณุจ</h3>
            <ul>
                <li>ุณุงุณุช ุนุฏู ุซุจุช ูุงฺฏ (No-Log Policy)</li>
                <li>ูพุฑูุชฺฉูโูุง ุงููุช ูู</li>
                <li>ุณุฑุนุช ู ูพุงุฏุงุฑ ุงุชุตุงู</li>
                <li>ุญูุฒู ูุถุง ููุงุณุจ</li>
                <li>ููุช ู ูพุดุชุจุงู</li>
            </ul>

            <h3>ูพุฑูุชฺฉูโูุง VPN</h3>
            <p>ุจุฑุฑุณ ูพุฑูุชฺฉูโูุง ูุฎุชูู ูุงููุฏ OpenVPNุ WireGuardุ IKEv2 ู ููุงุณู ุขูโูุง ุงุฒ ูุธุฑ ุงููุช ู ุณุฑุนุช.</p>
        `
    },
    4: {
        id: 4,
        title: 'ูพุงุชู ุงุฒ ุฑู ุณู ุจุฑุฏุงุฑ',
        date: 'ฑ ุงุฑุฏุจูุดุช ฑดฐณ',
        duration: '18:45',
        audioUrl: '#',
        thumbnail: '../assets/images/laye7/E4.png',
        content: `
            <h2>ุญูุธ ุงุฑุชุจุงุท ุฏุฑ ุดุฑุงุท ุจุญุฑุงู</h2>
            <p>ุฑุงูฺฉุงุฑูุง ุนูู ุจุฑุง ุญูุธ ุงุฑุชุจุงุท ุฏุฑ ุฒูุงู ูุทุน ุง ูุญุฏูุฏุช ุงูุชุฑูุช.</p>
            
            <h3>ุงุจุฒุงุฑูุง ุงุฑุชุจุงุท ุฌุงฺฏุฒู</h3>
            <ul>
                <li>ูพุงูโุฑุณุงูโูุง ุบุฑูุชูุฑฺฉุฒ</li>
                <li>ุดุจฺฉูโูุง Mesh</li>
                <li>ุงุฑุชุจุงุทุงุช ุฑุงุฏู</li>
                <li>ุงุณุชูุงุฏู ุงุฒ Bluetooth ู WiFi Direct</li>
            </ul>
        `
    },
    5: {
        id: 5,
        title: 'ูุงฺฏูุงู ููุชุงุ ุฏุฑุจุงุฑู ุจุณุชู ุตูุญูโูุง ุงูุณุชุงฺฏุฑุงู',
        date: 'ฑธ ูุฑูุฑุฏู ฑดฐณ',
        duration: '23:30',
        audioUrl: '#',
        thumbnail: '../assets/images/laye7/E5.png',
        content: `
            <h2>ุขูุงุฏฺฏ ุจุฑุง ูุทุน ุงูุชุฑูุช</h2>
            <p>ฺฺฏููู ูพุด ุงุฒ ูููุน ูุทุน ุงูุชุฑูุช ุขูุงุฏู ุดูู ู ฺู ุงูุฏุงูุงุช ุงูุฌุงู ุฏูู.</p>
            
            <h3>ุงูุฏุงูุงุช ูพุดฺฏุฑุงูู</h3>
            <ul>
                <li>ุฐุฎุฑูโุณุงุฒ ุงุทูุงุนุงุช ููู</li>
                <li>ุขูุงุฏูโุณุงุฒ ุงุจุฒุงุฑูุง ุงุฑุชุจุงุท ุขููุงู</li>
                <li>ุงุฌุงุฏ ุดุจฺฉู ุงุนุชูุงุฏ</li>
                <li>ุชูู ูุณุฎู ูพุดุชุจุงู ุงุฒ ุฏุงุฏูโูุง</li>
            </ul>
        `
    },
    6: {
        id: 6,
        title: 'ุชุญุช ูุธุงุฑุช ุจุฑุงุฏุฑ ุจุฒุฑฺฏ',
        date: 'ด ูุฑูุฑุฏู ฑดฐณ',
        duration: '26:10',
        audioUrl: '#',
        thumbnail: '../assets/images/laye7/E6.png',
        content: `
            <h2>ุฑูุดโูุง ูุฎุชูู ุณุงูุณูุฑ</h2>
            <p>ุจุฑุฑุณ ุฌุงูุน ุงููุงุน ุฑูุดโูุง ุณุงูุณูุฑ ู ููุชุฑูฺฏ ุฏุฑ ุงุฑุงู.</p>
            
            <h3>ูุงูโูุง ูุฎุชูู ุณุงูุณูุฑ</h3>
            <ul>
                <li>ููุชุฑูฺฏ DNS</li>
                <li>ูุณุฏูุฏุณุงุฒ IP</li>
                <li>ุจุงุฒุฑุณ ุนูู ุจุณุชูโูุง (DPI)</li>
                <li>ฺฉูุชุฑู ูุญุชูุง ูพุงูฺฉ</li>
                <li>ูุธุงุฑุช ุจุฑ ุดุจฺฉูโูุง ุงุฌุชูุงุน</li>
            </ul>
        `
    },
    7: {
        id: 7,
        title: 'ุงุณุชุงุฑููฺฉ ุฎูุจ ุงุณุชุงุฑููฺฉ ุตุงูุชโุดุฏู ุงุณุช',
        date: 'ฑน ุงุณููุฏ ฑดฐฒ',
        duration: '24:55',
        audioUrl: '#',
        thumbnail: '../assets/images/laye7/E7.png',
        content: `
            <h2>ุชูุฏุฏ ุฌุงุณูุณโุงูุฒุงุฑูุง</h2>
            <p>ุจุฑุฑุณ ุฌุงุณูุณโุงูุฒุงุฑูุง ููุฑุฏ ุงุณุชูุงุฏู ุฏุฑ ุงุฑุงู ู ุฑูุดโูุง ููุงุจูู ุจุง ุขูโูุง.</p>
            
            <h3>ุงููุงุน ุฌุงุณูุณโุงูุฒุงุฑูุง</h3>
            <ul>
                <li>ุฌุงุณูุณโุงูุฒุงุฑูุง ููุจุงู</li>
                <li>ูุฑูโุงูุฒุงุฑูุง ูุธุงุฑุช ุฏุณฺฉุชุงูพ</li>
                <li>ุงุจุฒุงุฑูุง ุดููุฏ ุชูุงุณ</li>
                <li>ุจุฑูุงููโูุง ุฑุฏุงุจ ูููุนุช</li>
            </ul>

            <h3>ุฑุงูฺฉุงุฑูุง ูุญุงูุธุช</h3>
            <p>ุงุณุชูุงุฏู ุงุฒ ูุฑูโุงูุฒุงุฑูุง ุงููุช ูุนุชุจุฑุ ุจูโุฑูุฒุฑุณุงู ููุธู ุณุณุชูโุนุงููุ ู ุงุฌุชูุงุจ ุงุฒ ูุตุจ ุจุฑูุงููโูุง ูุงุดูุงุฎุชู.</p>
        `
    },
    8: {
        id: 8,
        title: 'ูุณูุช ุตูุฑ: ูุงู ููุชู',
        date: 'ฒธ ุจููู ฑดฐฒ',
        duration: '20:00',
        audioUrl: '#',
        thumbnail: '../assets/images/laye7/E0.jpg',
        content: `
            <h2>ุฏุฑุจุงุฑู ุงู ุงูพุฒูุฏ</h2>
            <p>ูุนุฑู ูพุงุฏฺฉุณุช ูุงู ููุชู ู ููุถูุนุงุช ููุฑุฏ ุจุญุซ ุฏุฑ ุงู ูุฌููุนู.</p>
            
            <h3>ุฏุฑุจุงุฑู ูพุงุฏฺฉุณุช ูุงู ููุชู</h3>
            <p>ูพุงุฏฺฉุณุช ูุงู ููุชู ุจู ุจุฑุฑุณ ููุถูุนุงุช ูุฑุชุจุท ุจุง ููุชุฑูฺฏุ ุงููุช ุฏุฌุชุงูุ ู ฺุงูุดโูุง ูุถุง ูุฌุงุฒ ุฏุฑ ุงุฑุงู ูโูพุฑุฏุงุฒุฏ.</p>
        `
    }
};

// Load episode data
function loadEpisode() {
    const urlParams = new URLSearchParams(window.location.search);
    const episodeId = parseInt(urlParams.get('id'));
    
    console.log('Episode ID:', episodeId);
    
    const episode = podcastEpisodes[episodeId];
    
    console.log('Episode data:', episode);
    
    if (!episode) {
        console.log('Episode not found, redirecting...');
        window.location.href = 'podcast-layeh7.html';
        return;
    }

    // Update page title
    document.getElementById('pageTitle').textContent = episode.title + ' - ูพุงุฏฺฉุณุช ูุงู ููุชู';
    document.title = episode.title + ' - ูพุงุฏฺฉุณุช ูุงู ููุชู';
    
    // Update episode info
    document.getElementById('episodeTitle').textContent = `ุงูพุฒูุฏ ${episode.id}: ${episode.title}`;
    document.getElementById('episodeDate').textContent = episode.date;
    document.getElementById('episodeDuration').textContent = episode.duration;
    
    // Update player subtitle
    document.getElementById('playerSubtitle').textContent = `ุงูพุฒูุฏ ${episode.id}`;
    
    // Set main cover image
    const mainCover = document.getElementById('episodeCoverMain');
    if (mainCover) {
        const absolutePath = episode.thumbnail.replace('../', '/');
        mainCover.src = absolutePath;
        mainCover.alt = episode.title;
        console.log('Main cover image set to:', absolutePath);
    }
    
    // Set player cover image
    const playerCover = document.getElementById('playerCover');
    const playerIconFallback = document.getElementById('playerIconFallback');
    if (playerCover && playerIconFallback) {
        console.log('๐ผ๏ธ Setting up player cover image');
        console.log('Original thumbnail path:', episode.thumbnail);
        
        // Convert relative path to absolute path
        const absolutePath = episode.thumbnail.replace('../', '/');
        console.log('Absolute path:', absolutePath);
        
        // Setup error handler BEFORE setting src
        playerCover.onerror = function() {
            console.error('โ Failed to load image from:', this.src);
            this.style.display = 'none';
            playerIconFallback.style.display = 'block';
        };
        
        // Setup load handler BEFORE setting src
        playerCover.onload = function() {
            console.log('โ Image loaded successfully!');
            this.style.display = 'block';
            playerIconFallback.style.display = 'none';
        };
        
        // Set alt text
        playerCover.alt = episode.title;
        
        // Set the source - this triggers the load
        playerCover.src = absolutePath;
        console.log('Image src set to:', playerCover.src);
    } else {
        console.error('โ Player cover or fallback element not found!');
    }
    
    // Update audio player
    document.getElementById('audioSource').src = episode.audioUrl;
    document.getElementById('audioPlayer').load();
    
    // Update download button
    document.getElementById('downloadBtn').href = episode.audioUrl;
    
    // Load content
    document.getElementById('episodeContent').innerHTML = episode.content;
    
    // Load other episodes
    loadOtherEpisodes(episodeId);
}

// Load other episodes (excluding current one)
function loadOtherEpisodes(currentEpisodeId) {
    const container = document.getElementById('otherEpisodesList');
    if (!container) return;
    
    // Get all episodes except current one
    const otherEpisodes = Object.values(podcastEpisodes)
        .filter(ep => ep.id !== currentEpisodeId)
        .sort((a, b) => b.id - a.id); // Sort by newest first
    
    // Take maximum 6 episodes
    const displayEpisodes = otherEpisodes.slice(0, 6);
    
    container.innerHTML = displayEpisodes.map(episode => {
        const absolutePath = episode.thumbnail.replace('../', '/');
        return `
            <a href="podcast-episode.html?id=${episode.id}" class="other-episode-card">
                <img src="${absolutePath}" alt="${episode.title}" class="other-episode-thumbnail" onerror="this.src='/assets/images/audio.png'">
                <div class="other-episode-info">
                    <div class="other-episode-title">ุงูพุฒูุฏ ${episode.id}: ${episode.title}</div>
                    <div class="other-episode-duration">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        ${episode.duration}
                    </div>
                </div>
            </a>
        `;
    }).join('');
    
    console.log(`Loaded ${displayEpisodes.length} other episodes`);
}

// Share functions
function shareOnTwitter() {
    const url = window.location.href;
    const text = document.getElementById('episodeTitle').textContent;
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
}

function shareOnTelegram() {
    const url = window.location.href;
    const text = document.getElementById('episodeTitle').textContent;
    window.open(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`, '_blank');
}

function copyLink() {
    const url = window.location.href;
    navigator.clipboard.writeText(url).then(() => {
        if (window.toast) {
            window.toast.success('ููฺฉ ฺฉูพ ุดุฏ!');
        }
    }).catch(() => {
        if (window.toast) {
            window.toast.error('ุฎุทุง ุฏุฑ ฺฉูพ ฺฉุฑุฏู ููฺฉ');
        }
    });
}

// Load episode on page load
document.addEventListener('DOMContentLoaded', loadEpisode);
